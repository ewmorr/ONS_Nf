blast_res = read.table("data/fonseca_mt.blast", header = F)
blast_res
colnames(blast_res) = c(
"contig",
"dbID",
"perc_sim",
"length",
"mismatch",
"gapopen",
"qstart",
"qend",
"sstart",
"send",
"e-val",
"bitscore"
)
blast_res %>%
group_by(contig) %>%
summarize(sum_len = sum(length))
library(dplyr)
blast_res %>%
group_by(contig) %>%
summarize(sum_len = sum(length))
blast_res %>%
group_by(contig) %>%
summarize(sum_len = sum(length), n_hit = n())
scf_len = read.csv("data/scaffold_lengths.csv")
scf_len
scf_len = read.csv("data/scaffold_lengths.csv", header = F)
scf_len = read.table("data/scaffold_lengths.csv", header = F, sep = ",")
?read.table
scf_len = read.csv("data/scaffold_lengths.csv", header = F)
scf_len = read.table("data/scaffold_lengths.csv", header = F)
blast_res = read.table("data/fonseca_mt.blast", header = F)
scf_len = read.csv("data/scaffold_lengths.csv")
scf_len = read.csv("data/scaffold_lengths.csv")
scf_len = read.table("data/scaffold_lengths.txt", header = T)
scf_len = read.table("data/scaffold_lengths.txt")
q(save="no")
library(dplyr)
blast_res = read.table("data/fonseca_mt.blast", header = F)
scf_len = read.table("data/scaffold_lengths.txt", header = T)
scf_len
blast_res %>%
group_by(contig) %>%
summarize(sum_len = sum(hit_length), n_hit = n()) %>%
left_join(., scf_len, by = "contig")
colnames(blast_res) = c(
"contig",
"dbID",
"perc_sim",
"hit_length",
"mismatch",
"gapopen",
"qstart",
"qend",
"sstart",
"send",
"e-val",
"bitscore"
)
blast_res %>%
group_by(contig) %>%
summarize(sum_len = sum(hit_length), n_hit = n()) %>%
left_join(., scf_len, by = "contig")
colnames(scf_len) = c("contig", "contig_len")
scf_len
colnames(scf_len)
colnames(scf_len) = c("contig", "contig_len")
blast_res %>%
group_by(contig) %>%
summarize(sum_len = sum(hit_length), n_hit = n()) %>%
left_join(., scf_len, by = "contig")
blast_res %>%
group_by(contig) %>%
summarize(sum_len = sum(hit_length), n_hit = n()) %>%
left_join(., scf_len, by = "contig") %>%
summarize(prop_contig = sum_len/contig_len)
blast_res %>%
group_by(contig) %>%
left_join(., scf_len, by = "contig") %>%
summarize(sum_len = sum(hit_length), n_hit = n(), prop_contig = sum_len/contig_len)
blast_res %>%
left_join(., scf_len, by = "contig") %>%
group_by(contig) %>%
summarize(sum_len = sum(hit_length), n_hit = n(), prop_contig = sum_len/contig_len)
blast_res %>%
group_by(contig) %>%
left_join(., scf_len, by = "contig") %>%
group_by(contig) %>%
summarize(sum_len = sum(hit_length), n_hit = n(), prop_contig = sum_len/contig_len)
blast_res %>%
group_by(contig) %>%
summarize(tot_hit_len = sum(hit_length), n_hit = n())
blast_res %>%
group_by(contig) %>%
summarize(tot_hit_len = sum(hit_length), n_hit = n()) %>%
left_join(., scf_len, by = "contig")
blast_res %>%
group_by(contig) %>%
summarize(tot_hit_len = sum(hit_length), n_hit = n()) %>%
left_join(., scf_len, by = "contig") %>%
mutate(prop = tot_hit_len/contig_len)
blast_res %>%
group_by(contig) %>%
summarize(tot_hit_len = sum(hit_length), n_hit = n()) %>%
left_join(., scf_len, by = "contig") %>%
mutate(perc_contig = tot_hit_len/contig_len*100)
mt_hits = blast_res %>%
group_by(contig) %>%
summarize(tot_hit_len = sum(hit_length), n_hit = n()) %>%
left_join(., scf_len, by = "contig") %>%
mutate(perc_contig = tot_hit_len/contig_len*100)
write.table(mt_hits, "data/mt_hits_summary.txt", col.names = T, row.names = F, quote = F)
q(save="no")
